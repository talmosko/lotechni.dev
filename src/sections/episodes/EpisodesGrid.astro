---
import Heading from '@components/astro/typography/Heading.astro'
import EpisodeCard from '@components/astro/EpisodeCard.astro'
import SectionContainer from '@components/astro/containers/SectionContainer.astro'
interface Props {
  compact?: boolean
}

const { compact = false } = Astro.props
import { $showData } from '@stores/episodes'
import Button from '@components/astro/Button.astro'
import Icon from '@components/astro/Icon.astro'
import ListeningLinks from './ListeningLinks.astro'
const show = $showData.get().data

if (!show) {
  throw new Error('No show data found')
}
const parsedEpisodes = show.episodes.items

const sectionTitle = compact ? 'הפרקים האחרונים' : 'פרקים'
const shownEpisodes = compact ? parsedEpisodes.slice(0, 4) : parsedEpisodes
---

<SectionContainer>
  <Heading level={2} className="mb-8 text-center">{sectionTitle}</Heading>
  <ListeningLinks />
  <ul role="list" class="mx-auto grid grid-cols-1 gap-8 p-0 md:grid-cols-2">
    {shownEpisodes.map((episode) => <EpisodeCard {...episode} />)}
  </ul>

  {
    compact && (
      <div class="mt-8 flex justify-center">
        <Button size="xl" variant="link" class="flex items-center gap-2" href="/episodes">
          <Icon icon="headphones" />
          לכל הפרקים
        </Button>
      </div>
    )
  }
</SectionContainer>
