---
import Heading from '@components/astro/typography/Heading.astro'
import EpisodeCard from '@components/astro/EpisodeCard.astro'
import { fetchShowData } from '@utils/spotify'

interface Props {
  compact?: boolean
}

const { compact = false } = Astro.props
const show = await fetchShowData(import.meta.env.PUBLIC_SPOTIFY_SHOW_ID)
const parsedEpisodes = show.episodes.items

const sectionTitle = compact ? 'הפרקים האחרונים' : 'פרקים'
const shownEpisodes = compact ? parsedEpisodes.slice(0, 4) : parsedEpisodes
---

<div class="container space-y-12 py-8 text-xl leading-relaxed">
  <Heading level={2} className="text-center">{sectionTitle}</Heading>
  <ul role="list" class="mx-auto grid max-w-7xl grid-cols-1 gap-8 p-0 md:grid-cols-2">
    {shownEpisodes.map((episode) => <EpisodeCard {...episode} />)}
  </ul>
</div> 